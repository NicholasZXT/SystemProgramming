{
    "version": "2.0.0",
    "tasks": [
        // ----------------- settings.json配置打印任务 -----------------
        {
            "type": "shell",
            "label": "Print VS Custom Settings(Node.js)",
            "detail": "打印自定义设置变量(Node.js版)",
            "command": "node",
            "args": [".vscode/print-vsc-settings.js"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "type": "shell",
            "label": "Print VS Custom Settings(Python)",
            "detail": "打印自定义设置变量(Python版)",
            "command": "python",
            "args": [".vscode/print-vsc-settings.py"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },

        // ----------------- C编译任务，使用gcc -----------------
        {
            // cppbuild 类型不支持  ${config:xxx} 变量展开，所以改为shell
            // "type": "cppbuild",
            "type": "shell",
            "label": "GCC/Compile",
            "detail": "GCC/C编译任务",
            // ----------------------------------------------------------------
            // 注意，即使这里配置了UCRT64环境下的 gcc/g++ 路径，
            // 还需要将 UCRT64环境的 bin 目录加入到PATH环境变量里！！！
            // 因为gcc还依赖 UCRT64环境里的其他程序，这一点对于Rust也适用。
            // ----------------------------------------------------------------
            // "command": "D:\\MyProgramFiles\\msys64\\ucrt64\\bin\\gcc.exe",
            // command 字段只在 shell 类型下支持使用 ${config:xxx} 进行变量展开，cppbuild类型不支持
            "command": "${config:custom.msys.home}\\ucrt64\\bin\\gcc.exe",
            // 但是 cppbuild 类型支持 VS-Code 内置预定义变量的展开
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${cwd}${/}build${/}${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "${cwd}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "presentation": {
                "echo": true,
                // "reveal": "always",
                "revealProblems": "onProblem",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": false,
                "clear": false
            }
        },

        // ----------------- C++ 编译任务，使用g++ -----------------
        {
            // "type": "cppbuild",
            "type": "shell",
            "label": "G++/Compile",
            "detail": "G++/C++程序编译任务",
            // "command": "D:\\MyProgramFiles\\msys64\\ucrt64\\bin\\g++.exe",
            "command": "${config:custom.msys.home}\\ucrt64\\bin\\g++.exe",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${cwd}${/}build${/}${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "${cwd}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": false
            }
        },

        // ----------------- C/C++ 清理任务，删除已构建文件 -----------------
        {
            "type": "shell",
            "label": "Clean C/C++ Build Files",
            "detail": "删除调试时构建的C/C++文件",
            "command": "rm",
            "args": [
                "-f",
                // "${cwd}${/}build${/}${fileBasenameNoExtension}.exe"
                "${cwd}${/}build${/}*"
            ],
            "windows":{
                "command": "Remove-Item",
                "args": [
                    "-Force",
                    // "${cwd}${/}build${/}${fileBasenameNoExtension}.exe"
                    "${cwd}${/}build${/}$*"
                ]
            },
            "presentation": {
                "echo": true,
                "revealProblems": "onProblem",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            }
        },

        // ----------------- Rust 构建任务 -----------------
        {
            "type": "shell",
            "label": "Rust Cargo Build",
            "detail": "Rust程序编译任务",
            "command": "cargo.exe",
            "args": [
                "build",
                "--bin=${fileBasenameNoExtension}"
            ],
            "options": {
                "cwd": "${cwd}"
            },
            "group": {
                "kind": "build",
                "isDefault": false
            }
        },

        // ----------------- Rust 清理任务 -----------------
        {
            "type": "shell",
            "label": "Rust Cargo Clean",
            "detail": "Rust程序清理任务",
            "command": "cargo",
            "args": [
                "clean"
            ],
            "options": {
                "cwd": "${cwd}"
            },
            "windows": {
                "command": "cargo.exe",
                "args": [
                    "clean"
                ]
            },
        }
    ]
}